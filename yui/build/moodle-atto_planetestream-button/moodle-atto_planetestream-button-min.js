YUI.add("moodle-atto_planetestream-button",function(t,e){var a,o,i,n;t.namespace("M.atto_planetestream").Button=t.Base.create("button",t.M.editor_atto.EditorPlugin,[],{initializer:function(){this.get("disabled")||this.addButton({icon:"button",iconComponent:"atto_planetestream",title:"pluginname",buttonName:"button",callback:this._displayDialogue})},_listen:function(){window.addEventListener?(a="addEventListener",o="message"):window.postMessage?(a="attachEvent",o="onmessage"):i._insertContent("Sorry, your web-browser is not compatible with this feature."),(0,window[a])(o,function(t){if("mod-assign-editsubmission"==i.get("pagetype")){var e=t.data,a="Assignment Submission";try{a=e.split("&")[1].split("=")[1],a=(a=decodeURIComponent(a)).split("+").join(" ")}catch(t){console.log(t)}i._insertContent('<a href="'+i.get("estream_url")+"/View.aspx?"+t.data+'&delta=ESDLTA" target="_blank">'+a+"</a><br><br>")}else 0==i.get("estream_width")&&0==i.get("estream_height")?i._insertContent('<div style="position:relative;overflow:hidden;padding-top:56.25%;"><iframe allow="autoplay; fullscreen" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;" src="'+i.get("estream_url")+"/Embed.aspx?"+t.data+'&delta=ESDLTA"></iframe><a href="/_planetestreamiframe_/Embed.aspx?'+t.data+'&delta=ESDLTA">&nbsp;</a></div>'):i._insertContent('<iframe allow="autoplay; fullscreen" allowfullscreen style="width: '+i.get("estream_width")+"px; height: "+i.get("estream_height")+'px; border: 0" src="'+i.get("estream_url")+"/Embed.aspx?"+t.data+'&delta=ESDLTA"></iframe><a href="_planetestreamiframe_/Embed.aspx?'+t.data+'&delta=ESDLTA"></a>');t.target.removeEventListener(t.type,arguments.callee)},!1)},_insertContent:function(t){i.getDialogue().hide(),i.editor.focus(),i.get("host").insertContentAtFocusPoint(t),i.markUpdated()},_displayDialogue:function(e){e.preventDefault();var a=this.getDialogue({headerContent:"Insert Planet eStream Item",width:"1000px",height:"700px"});"1000px"!==a.width&&a.set("width","1000px"),"700px"!==a.width&&a.set("height","700px"),(n=t.Node.create("<div></div>")).append('<form class="atto_form"><div class="mdl-align" style="overflow:auto;-webkit-overflow-scrolling:touch;"><iframe allow="microphone; camera;" id="ifestream" style="border: 0px; width: '+(parseInt(1e3,10)-78)+"px;height: "+(parseInt(700,10)-65)+'px;" src="'+this.get("estream_url")+this.get("estream_path")+"&td="+window.location.protocol+"//"+window.location.host+":"+(("80"===window.location.port&&"http"===window.location.protocol)|("443"===window.location.port&&"https"===window.location.protocol)?"":window.location.port)+'"></iframe></div></form>'),a.set("bodyContent",n),a.show(),this.markUpdated(),(i=this)._listen()}},{ATTRS:{disabled:{value:!1},usercontextid:{value:null},estream_url:{value:""},estream_path:{value:""},estream_height:{value:""},estream_width:{value:""},pagetype:{value:""}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});

//new old
//YUI.add("moodle-atto_planetestream-button",function(t,e){var a,o,i,n;t.namespace("M.atto_planetestream").Button=t.Base.create("button",t.M.editor_atto.EditorPlugin,[],{initializer:function(){this.get("disabled")||this.addButton({icon:"button",iconComponent:"atto_planetestream",title:"pluginname",buttonName:"button",callback:this._displayDialogue})},_listen:function(){window.addEventListener?(a="addEventListener",o="message"):window.postMessage?(a="attachEvent",o="onmessage"):i._insertContent("Sorry, your web-browser is not compatible with this feature."),(0,window[a])(o,function(t){if("mod-assign-editsubmission"==i.get("pagetype")){var e=t.data.split("&")[1].split("=")[1];e=(e=decodeURIComponent(e)).split("+").join(" "),i._insertContent('<a href="'+i.get("estream_url")+"/View.aspx?"+t.data+'&delta=ESDLTA" target="_blank">'+e+"</a><br><br>")}else 0==i.get("estream_width")&&0==i.get("estream_height")?i._insertContent('<div style="position:relative;overflow:hidden;padding-top:56.25%;"><iframe allow="autoplay; fullscreen" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;" src="'+i.get("estream_url")+"/Embed.aspx?"+t.data+'&delta=ESDLTA"></iframe><a href="/_planetestreamiframe_/Embed.aspx?'+t.data+'&delta=ESDLTA">&nbsp;</a></div>'):i._insertContent('<iframe allow="autoplay; fullscreen" allowfullscreen style="width: '+i.get("estream_width")+"px; height: "+i.get("estream_height")+'px; border: 0" src="'+i.get("estream_url")+"/Embed.aspx?"+t.data+'&delta=ESDLTA"></iframe><a href="_planetestreamiframe_/Embed.aspx?'+t.data+'&delta=ESDLTA"></a>');t.target.removeEventListener(t.type,arguments.callee)},!1)},_insertContent:function(t){i.getDialogue().hide(),i.editor.focus(),i.get("host").insertContentAtFocusPoint(t),i.markUpdated()},_displayDialogue:function(e){e.preventDefault();var a=this.getDialogue({headerContent:"Insert Planet eStream Item",width:"1000px",height:"700px"});"1000px"!==a.width&&a.set("width","1000px"),"700px"!==a.width&&a.set("height","700px"),(n=t.Node.create("<div></div>")).append('<form class="atto_form"><div class="mdl-align" style="overflow:auto;-webkit-overflow-scrolling:touch;"><iframe allow="microphone; camera;" id="ifestream" style="border: 0px; width: '+(parseInt(1e3,10)-78)+"px;height: "+(parseInt(700,10)-65)+'px;" src="'+this.get("estream_url")+this.get("estream_path")+"&td="+window.location.protocol+"//"+window.location.host+":"+(("80"===window.location.port&&"http"===window.location.protocol)|("443"===window.location.port&&"https"===window.location.protocol)?"":window.location.port)+'"></iframe></div></form>'),a.set("bodyContent",n),a.show(),this.markUpdated(),(i=this)._listen()}},{ATTRS:{disabled:{value:!1},usercontextid:{value:null},estream_url:{value:""},estream_path:{value:""},estream_height:{value:""},estream_width:{value:""},pagetype:{value:""}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});

//old old
//YUI.add("moodle-atto_planetestream-button",function(e,t){var n,r,i,s=1e3,o=700,u,a;e.namespace("M.atto_planetestream").Button=e.Base.create("button",e.M.editor_atto.EditorPlugin,[],{initializer:function(){if(this.get("disabled"))return;this.addButton({icon:"button",iconComponent:"atto_planetestream",title:"pluginname",buttonName:"button",callback:this._displayDialogue})},_listen:function(){window.addEventListener?(n="addEventListener",r="message"):window.postMessage?(n="attachEvent",r="onmessage"):i._insertContent("Sorry, your web-browser is not compatible with this feature.");var e=window[n];e(r,function(e){0==i.get("estream_width")&&0==i.get("estream_height")?i._insertContent('<div style="position:relative;overflow:hidden;padding-top:56.25%;"><iframe allow="autoplay; fullscreen" allowfullscreen style="position:absolute;top:0;left:0;width:100%;height:100%;border:0;" src="'+i.get("estream_url")+"/Embed.aspx?"+e.data+'&delta=ESDLTA"></iframe><a href="'+"_planetestreamiframe_/Embed.aspx?"+e.data+'&delta=ESDLTA"></a></div>'):i._insertContent('<iframe allow="autoplay; fullscreen" allowfullscreen style="width: '+i.get("estream_width")+"px; height: "+i.get("estream_height")+'px; border: 0" src="'+i.get("estream_url")+"/Embed.aspx?"+e.data+'&delta=ESDLTA"></iframe><a href="'+"_planetestreamiframe_/Embed.aspx?"+e.data+'&delta=ESDLTA"></a>'), e.target.removeEventListener(e.type, arguments.callee);},!1)},_insertContent:function(e){a||(i.getDialogue().hide(),i.editor.focus(),i.get("host").insertContentAtFocusPoint(e),i.markUpdated())},_displayDialogue:function(t){t.preventDefault();var n=this.getDialogue({headerContent:"Insert Planet eStream Item",width:s+"px",height:o+"px"});n.width!==s+"px"&&n.set("width",s+"px"),n.width!==o+"px"&&n.set("height",o+"px"),u=e.Node.create("<div></div>"),u.append('<form class="atto_form"><div class="mdl-align" style="overflow:auto;-webkit-overflow-scrolling:touch;"><iframe allow="microphone; camera;" id="ifestream" style="border: 0px; width: '+(parseInt(s,10)-78)+"px;"+"height: "+(parseInt(o,10)-65)+'px;" src="'+this.get("estream_url")+this.get("estream_path")+"&td="+window.location.protocol+"//"+window.location.host+":"+((window.location.port === '80' && window.location.protocol==='http')|(window.location.port==='443' && window.location.protocol==='https')?'':window.location.port)+'"></iframe></div></form>'),n.set("bodyContent",u),n.show(),this.markUpdated(),i=this,i._listen()}},{ATTRS:{disabled:{value:!1},usercontextid:{value:null},estream_url:{value:""},estream_path:{value:""},estream_height:{value:""},estream_width:{value:""}}})},"@VERSION@",{requires:["moodle-editor_atto-plugin"]});

